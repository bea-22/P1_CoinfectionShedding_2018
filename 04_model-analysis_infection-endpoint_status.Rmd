---
title: "03_model-analysis_infection-endpoint_status"
author: "Bryony Allen"
date: "09/05/2019"
output: word_document
---

```{r packages, include=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Install & load in required packages 

# for tidying data  
library(dplyr)
# library(tidyr)
# library(tibble)

# for plotting 
library(ggplot2) 
library(lattice)

# for stats 
library(binom)
# library(purr)  # purr guidance > for evaluating models http://ijlyttle.github.io/isugg_purrr/presentation.html#(1) 
# library(broom)   # broom summarizes key information about models in tidy tibble()s >> https://github.com/tidymodels/broom
```

# Part 1: Import data 

> **N.B.**   At the moment this code chuck reads in a .csv file with endpoint infection data, originally compiled in excel and then cleaned in "02_tidy_data-qpcr"script. In the future you will read in the .csv file of merged qPCR outputs (created, checked and cleaned in "02_tidy_data-qpcr"script) and experiment metadata (checked and cleaned in "02_tidy_data-metadata"script). 

<br>
```{r import data, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
data.endpoint <- read.csv('data/02_clean-data.csv') 

glimpse(data.endpoint)   #check how the dataset has imported (aka whether it has the data type right)  
```

# Part 2: Visualise data 

```{r import proportion data , include=FALSE, warning=FALSE, error=FALSE, message=FALSE}
prop.infect.sum <- read.csv('data/03_prop-sum_data.csv') 
```

```{r graph labels, include=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# make label vectors to use in plots
sp.labs <- c(Bb = "Bufo bufo", Rt = "Rana temporaria", Am = "Alytes muletensis")
exp.labs <- c("1" = "Bufo bufo I", "2" = "Bufo bufo II", "3" = "Rana temporaria", "4" = "Alytes muletensis","5" = "Alytes muletensis II")
exp.short.labs <- c("1" = "Bb1", "2" = "Bb2", "3" = "Rt", "4" = "Am")
infect.labs <- c(Bd = "Bd infection", Rv = "Rv infection")
expos.labs <- c("1" = "Bd", "2" = "Rv", "3" = "Bd-Rv", "4"="Rv-Bd")

```

```{r proportion infected by species, echo=FALSE}
plot.endpoint.prop.sp <- 
  prop.infect.sum %>% 
  filter(!ExperimentNo=='5')  %>% 
    ggplot(aes(x=Treatment, y= proportion.infected, fill=InfectType ))+ 
      geom_bar(position= "dodge", stat="identity") + 
      scale_x_discrete(name ="Treatment Group", limits=c("Bd","Rv","Bd-Rv", "Rv-Bd")) +       #change the order of the x axis ticks
      geom_errorbar(aes(ymin=upper, ymax=lower), width= .2, position= position_dodge(0.9)) +   #alpha to change transparancy 
      facet_grid(.~ExperimentNo, labeller=labeller(ExperimentNo = exp.labs)) + 
      theme(strip.text.x = element_text(size=12, face="italic")) +
      labs(x="Treatment Group",y="Proportion Infected") + 
      guides(fill=guide_legend(title="Pathogen")) 


plot.endpoint.prop.sp + theme(legend.position="top",legend.justification='right', legend.direction='horizontal') + theme(legend.key=element_blank()) + theme(axis.text.x = element_text(angle=30, hjust=1,vjust=1)) + theme(axis.title = element_text(size=14))

```

# Part 3: Apply models to Endpoint Infection Status

Binomial GLM's where    
<br>
    response variable = Endpoint status [binary; 0,1]   
  <br>
    explanatory variable(s) = Treatment  [categorical]   &   ExperimentNo. [categorical]

<br>
  
  
**N.B.**  I use ExperimentNo as a proxy for species where

Experiment No. | Species              | total Bd zsp's   | min. temp. (^o^C) | max. temp. (^o^C)
---------- |------------------------- | -------------| -------------|------------- 
1 | *Bufo bufo* I          | 3,675,000    | 16.6        | 23.5     
2 | *Bufo bufo* II         | 1,443,750   | 16.7        | 27.6    
3 | *Rana temporaria*     | 2,336,250     | 16.7         | 27.6    
4 | *Alytes muletensis* I  | 472,500      | 15     | 16.6 
5 | *Alytes muletensis* II | 294,759      | 15     | 16.6 

... as this also accounts for Bd dose and room temperature variation between experiments. 


## Part 3a: Endpoint Infection Status: **Bd** 

Here I create a dataframe with the Rv-only treatment group removed (as they have never been exposed to Bd) and without *Alytes muletensis* babies as they only have one treatment group which I analyse seperately later.   

<br>
```{r Bd status df, results='hide', warning=FALSE, error=FALSE, message=FALSE}
Bd.status <- data.endpoint %>%
  filter(!Treatment=="Rv") %>%   # removal of Rv only treatment group 
  filter(!ExperimentNo=='5')  %>%   # removal of Alytes babies
  mutate(ExperimentNo = as.factor(ExperimentNo)) %>%   
  select(ID, Species, ExperimentNo, Scenario, Treatment, Bd.endpoint.status, Bd.endpoint.GE) 

droplevels(Bd.status)
```

### Model Comparison

The four models: 
```{r Bd glm}
Bd.status1 <- glm(Bd.endpoint.status ~ Treatment * ExperimentNo, data=Bd.status, family=binomial)

Bd.status2 <- glm(Bd.endpoint.status ~ Treatment + ExperimentNo, data=Bd.status, family=binomial)

Bd.status3 <- glm(Bd.endpoint.status ~ Treatment, data=Bd.status, family=binomial)

Bd.status4 <- glm(Bd.endpoint.status ~ ExperimentNo, data=Bd.status, family=binomial)
```

Models compared using analysis of deviance with ```test='Chi'``` selected because of the binomial error family. This tests whether... "the more complex model is significantly better at capturing the data than the simpler model. If the resulting p-value is sufficiently low (usually less than 0.05), we conclude that the more complex model is significantly better than the simpler model, and thus favor the more complex model. If the p-value is not sufficiently low (usually greater than 0.05), we should favor the simpler model."

<br>

```{r Bd glm anova}
anova(Bd.status2, Bd.status4, test="Chisq") # compares Trt and Sp to just Sp 

anova(Bd.status2, Bd.status3, test="Chisq") # compares Trt and Sp to just Trt 

anova(Bd.status1, Bd.status2, test="Chisq")  # compare more complex model to one with interaction 
```
ANOVA 1: suggests we should reject the more complex model (Treatment + ExperimentNo) in favour for just the model with ExperimentNo only  (pvalue = 0.48)
<br>

ANOVA 2: suggests we should favour the more complex model (Treatment + ExperimentNo) over the model with Treatment only  (pvalue = < .001)  as adding ExperimentNo did lead to significantly improved fit 
<br>

ANOVA 3: shows adding a interaction term between Treatment and ExperimentNo did not significantly imporve fit (p-value = 0.5752)

**Conclusion**: we should choose the model with just ExperimentNo (aka species) 

### Model Fit:   
To see the fitted values from a regression object (the values of the dependent variable predicted by the model), access the ```fitted.values``` attribute from a regression object with ````$fitted.values```.

```{r Bd fitted values, results='hide', warning=FALSE, error=FALSE, message=FALSE}
names(Bd.status4)   # look at the components of the glm object

Bd.status$bi.glm <- Bd.status4$fitted.values  # add logisitic fitted values back to the dataframe as a new col

head(Bd.status) 
```

### Model Plotting:   
To plot the model you need a range of values for which to produce fitted values. Then use the ```predict()``` function to create the model for all the values. ```predict()``` gives you the predicted values based on your (fitted) linear model, the argument type="response" will give you the predicted probabilities 

```{r Bd - bi.glm - predicted values, include=TRUE, warning=FALSE, error=FALSE, message=FALSE}
Bd.status4 <- glm(Bd.endpoint.status ~ ExperimentNo, data=Bd.status, family=binomial)

# create a dataframe of "new" data 
newdat <- expand.grid(ExperimentNo=c("1", "2", "3", "4"),Treatment=c("Bd", "Bd-Rv", "Rv-Bd"))

# predict the value/result of the new data using the glm
newdat <-cbind(newdat, predict(object = Bd.status4,   # the model 
                               newdata=newdat, se=TRUE, type="response", print.matrix=T))  # dataframe of new data 
newdat

expl.var <- c(1:3) # chose the range for the x-axis (Treatment)
exp.labs <- c("1" = "Bufo bufo I", "2" = "Bufo bufo II", "3" = "Rana temporaria", "4" = "Alytes muletensis")

# subset the data so you can plot each seperatly 
newdat1<- subset(newdat, ExperimentNo== "1")    
newdat2<- subset(newdat, ExperimentNo=="2")
newdat3<- subset(newdat, ExperimentNo=="3")
newdat4<- subset(newdat, ExperimentNo=="4")

```


```{r Bd - bi.glm - plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
Bd.status.predict <- ggplot(newdat, aes(x= expl.var, y= fit, color=ExperimentNo)) +       # plot model estimates, color= the data you subsetted by
  geom_line(data = newdat1, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat1, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat1
  geom_line(data = newdat2, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat2
  geom_errorbar(data = newdat2, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat2
  geom_line(data = newdat3, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat3
  geom_errorbar(data = newdat3, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat3
  geom_line(data = newdat4, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat4
  geom_errorbar(data = newdat4, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1) +       # error bars for subset newdat4
    scale_x_continuous(breaks=seq(1:3),labels=c("Bd", "Bd-Rv", "Rv-Bd"))    # sets the breaks at 1,2 and 3 which correspond to the label names
      
Bd.status.predict.plot <- Bd.status.predict + 
  ylab("Bd status predictions\n(fit)") +            # TO DO: would be good to have the axis marked at 0 & 1 
  xlab("Treatment Group") +
  ggtitle("Probability of Bd infection predicted by\n glm(Bd.endpoint.status ~ ExperimentNo, family = binomial)") +
  #guides(fill=guide_legend(title="Species")) +      # TO DO: fix the labelling issues here 
  # scale_fill_discrete(labels=exp.labs) +
  theme_bw() +
  theme(panel.border = element_blank(), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) 

# ggsave("figs/04_Bd_status_sp.png", plot= Bd.status.predict.plot, device=NULL)    # export plot as .png 

Bd.status.predict.plot

```

?? **QUESTION** have I plotted this correctly? Wonder whether Experiment No. should be the explanatory variable ?? 

This is the model predictions for Bd status with ExperimentNo. and Treatment 
```{r plot - bi.glm - species and treatment, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
Bd.status2 <- glm(Bd.endpoint.status ~ Treatment + ExperimentNo, data=Bd.status, family=binomial)

# create a dataframe of "new" data 
newdat <- expand.grid(ExperimentNo=c("1", "2", "3", "4"),Treatment=c("Bd", "Bd-Rv", "Rv-Bd"))

# predict the value/result of the new data using the glm
newdat <-cbind(newdat, predict(object = Bd.status2,   # the model 
                               newdata=newdat, se=TRUE, type="response", print.matrix=T))  # dataframe of new data 
newdat

expl.var <- c(1:3) # chose the range for the x-axis (Treatment)
exp.labs <- c("1" = "Bufo bufo I", "2" = "Bufo bufo II", "3" = "Rana temporaria", "4" = "Alytes muletensis")  #TO DO sort out your labels!!!! should be treatment 

newdat1<- subset(newdat, ExperimentNo== "1")    # need to subset the data so you can plot each seperatly 
newdat2<- subset(newdat, ExperimentNo=="2")
newdat3<- subset(newdat, ExperimentNo=="3")
newdat4<- subset(newdat, ExperimentNo=="4")

Bd.status.predict2 <- ggplot(newdat, aes(x= expl.var, y= fit, color=ExperimentNo)) +       # plot model estimates, color= the data you subsetted by
  geom_line(data = newdat1, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat1, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat1
  geom_line(data = newdat2, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat2
  geom_errorbar(data = newdat2, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat2
  geom_line(data = newdat3, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat3, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat1
  geom_line(data = newdat4, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat4, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1) +       # error bars for subset newdat1
    scale_x_continuous(breaks=seq(1:3),labels=c("Bd", "Bd-Rv", "Rv-Bd"))    # sets the breaks at 1,2 and 3 which correspond to the label names
      
Bd.status.predict.plot2 <- Bd.status.predict2 + 
  ylab("Bd status predictions\n(fit)") +            # TO DO: would be good to have the axis marking 0 & 1 
  xlab("Treatment Group") +
  ggtitle("Probability of Bd infection predicted by\n glm(Bd.endpoint.status ~ Treatment + ExperimentNo, 
    family = binomial)") +
  #guides(fill=guide_legend(title="Species")) +      # TO DO: fix the labelling issues here 
  #scale_fill_discrete(labels=exp.labs) +
  theme_bw() +
  theme(panel.border = element_blank(), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) 

Bd.status.predict.plot2
```



### Models Checks 

Here I check the two best models.

#### Maximal Model: Species + Treamtent (no interaction)
Fit the most complex model first, with the main effects for ExperimentNo. and Treatment. 

Look at the estimates of the coefficients using ```summary()```
```{r Bd - bi.glm - checks1, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Bd.status2 <- glm(Bd.endpoint.status ~ Treatment + ExperimentNo, data=Bd.status, family=binomial)
summary(Bd.status2)   # Residual deviance: 106.76  on 240 df   AIC: 120.76
```

```{r Bd - bi.glm - checks1 plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE }
par(mfrow=c(2,2), mar=c(3,3,3,1), mgp=c(2,0.8,0))
plot(Bd.status2)
```

<br>

The diagnostic plots for `glm(Bd.endpoint.status ~ Treatment + ExperimentNo)` aren't ideal 
- residual vs. fitted shows patterning meaning the variance is non-consistent
- residual vs. leverage also shows patterning suggesting certain data points have strong influence  

#### Simplified Model: Species 
Now fit a simpler model has an with only ExperimentNo.  
```{r Bd - bi.glm - checks2, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Bd.status4 <- glm(Bd.endpoint.status ~ ExperimentNo, data=Bd.status, family=binomial)
summary(Bd.status4)
```

```{r Bd - bi.glm - checks2 plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}

par(mfrow=c(2,2), mar=c(3,3,3,1), mgp=c(2,0.8,0))
plot(Bd.status4)
```

<br>
The diagnostic plots for `glm(Bd.endpoint.status ~ ExperimentNo)` aren't much better 

- residual vs. fitted shows patterning meaning the variance is non-consistent
- residual vs. leverage also shows patterning suggesting certain data points have strong influence  

```{r Bd - bi.glm - residuals2 plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
hist(resid(Bd.status2))  # check the residuals 
```


## Part 3b: Endpoint Infection Status: **Ranavirus** 

Here I create a dataframe with the Bd-only treatment group removed (as they have never been exposed to Rv) and without *Alytes muletensis* babies as they don't have Rv tratment groups.   

```{r Rv status df, results='hide', warning=FALSE, error=FALSE, message=FALSE}
Rv.status <- data.endpoint %>%
  filter(!Treatment=="Bd") %>%
  filter(!ExperimentNo=='5')  %>% 
  mutate(ExperimentNo = as.factor(ExperimentNo)) %>% 
  select(ID, Species, ExperimentNo, Scenario, Treatment, Rv.MCPendpoint.status, Rv.endpoint.load) 

droplevels(Rv.status)

```


### Model Comparison

The four models: 
```{r Rv glm}
Rv.status1 <- glm(Rv.MCPendpoint.status ~ Treatment * ExperimentNo, data=Rv.status, family=binomial)

Rv.status2 <- glm(Rv.MCPendpoint.status ~ Treatment + ExperimentNo, data=Rv.status, family=binomial)

Rv.status3 <- glm(Rv.MCPendpoint.status ~ Treatment, data=Rv.status, family=binomial)

Rv.status4 <- glm(Rv.MCPendpoint.status ~ ExperimentNo, data=Rv.status, family=binomial)
```

Again models compared using analysis of deviance with ```test='Chi'``` selected because of the binomial error family. This tests whether... "the more complex model is significantly better at capturing the data than the simpler model. If the resulting p-value is sufficiently low (usually less than 0.05), we conclude that the more complex model is significantly better than the simpler model, and thus favor the more complex model. If the p-value is not sufficiently low (usually greater than 0.05), we should favor the simpler model."

<br>
```{r Rv glm anova}
anova(Rv.status2, Rv.status4, test="Chisq") # compares Trt and Sp to just Sp 

anova(Rv.status2, Rv.status3, test="Chisq") # compares Trt and Sp to just Trt 

anova(Rv.status1, Rv.status2, test="Chisq")  # compare more complex model to one with interaction 
```

ANOVA 1: suggests we should favour the more complex model (Treatment + ExperimentNo) in favour for just the model with ExperimentNo only  (pvalue = < .001)  adding Treatment did lead to significantly improved fit 

ANOVA 2: suggests we should reject the more complex model (Treatment + ExperimentNo) over the model with Treatment only  (pvalue = 0.07962) 

ANOVA 3: shows adding a interaction term between Treatment and ExperimentNo did not significantly imporve fit (p-value = 0.4642)

**Conclusion**: we should choose the model with just Treatment

### Model Fit:   
To see the fitted values from a regression object (the values of the dependent variable predicted by the model), access the ```fitted.values``` attribute from a regression object with ````$fitted.values```.

```{r Rv fitted values, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
Rv.status$bi.glm <- Rv.status3$fitted.values  # add logisitic fitted values back to the dataframe as a new col

head(Rv.status)   
```

?? **QUESTION** Is this good enough ?? 
It looks like the model is struggling to predict the probability of Rv infection status accurately. 

### Model Plotting:   

```{r Rv - bi.glm - predictors, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
Rv.status3 <- glm(Rv.MCPendpoint.status ~ Treatment, data=Rv.status, family=binomial)

# create a dataframe of "new" data 
Rv.newdat <- expand.grid(ExperimentNo=c("1", "2", "3", "4"),Treatment=c("Bd-Rv", "Rv", "Rv-Bd"))

# predict the value/result of the new data using the glm
Rv.newdat <-cbind(Rv.newdat, predict(object = Rv.status3,   # the model 
                      newdata=Rv.newdat, se=TRUE, type="response", print.matrix=T))  # dataframe of new data 
Rv.newdat

expl.var <- c(1:3) # chose the range for the x-axis (Treatment)
exp.labs <- c("1" = "Bufo bufo I", "2" = "Bufo bufo II", "3" = "Rana temporaria", "4" = "Alytes muletensis")

newdat1<- subset(Rv.newdat, ExperimentNo== "1")    # need to subset the data so you can plot each seperatly 
newdat2<- subset(Rv.newdat, ExperimentNo=="2")
newdat3<- subset(Rv.newdat, ExperimentNo=="3")
newdat4<- subset(Rv.newdat, ExperimentNo=="4")
```

```{r Rv - bi.glm - plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
Rv.status.predict <- ggplot(Rv.newdat, aes(x= expl.var, y= fit)) +       # plot model estimates, color= the data you subsetted by
  geom_line(data = newdat1, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat1, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat1
  geom_line(data = newdat2, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat2
  geom_errorbar(data = newdat2, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat2
  geom_line(data = newdat3, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat3, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1)  +      # error bars for subset newdat1
  geom_line(data = newdat4, aes(x= expl.var, y= fit), size=1) +                                   # add lines for subset newdat1
  geom_errorbar(data = newdat4, aes(ymin=fit-se.fit, ymax=fit+se.fit), width=.03, size=1) +   scale_x_continuous(breaks=seq(1:3),labels=c("Bd-Rv", "Rv", "Rv-Bd"))    # sets the breaks at 1,2 and 3 which correspond to the label names

Rv.status.predict.plot <- Rv.status.predict + 
  ylab("Rv status predictions\n(fit)") +            # TO DO: would be good to have the axis marking 0 & 1 
  xlab("Treatment Group") +
  ggtitle("Probability of Ranavirus infection predicted by\n glm(Rv.MCPendpoint.status ~ Treatment, 
    family = binomial)") +
  theme_bw() +
  theme(panel.border = element_blank(), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) 

# ggsave("figs/04_Bd_status_sp.png", plot= Bd.status.predict.plot, device=NULL)    # export plot as .png 


Rv.status.predict.plot
```

?? **QUESTION** have I plotted this correctly? I think it makes sense, there is one overal effect of Treatment so i groups or has overlaid the ExxperimentNo./Species  


### Models Checks 

Here I check the two best models.

#### Maximal Model: Species + Treamtent (no interaction)
Fit the most complex model first, with the main effects for ExperimentNo. and Treatment. 

Look at the estimates of the coefficients using ```summary()```
```{r Rv - bi.glm - checks1, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Rv.status2 <- glm(Rv.MCPendpoint.status ~ Treatment + ExperimentNo, data=Rv.status, family=binomial)
summary(Rv.status2)  # Residual deviance: 106.76  on 240 df   AIC: 120.76
```

```{r Rv - bi.glm - checks1 plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE }
par(mfrow=c(2,2), mar=c(3,3,3,1), mgp=c(2,0.8,0))
plot(Rv.status2)
```
<br>

The diagnostic plots for `glm(Rv.MCPendpoint.status ~ Treatment + ExperimentNo)` again aren't ideal 

- QQ plot is iffy 
- residual vs. fitted shows patterning meaning the variance is non-consistent
- residual vs. leverage also shows patterning suggesting certain data points have strong influence  

#### Simplified Model: Treatment 
Now fit a simpler model has an with only Treatment  
```{r Rv - bi.glm checks2, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Rv.status3 <- glm(Rv.MCPendpoint.status ~ Treatment, data=Rv.status, family=binomial)
summary(Rv.status3)
```

```{r Rv - bi.glm - checks2 plot, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
par(mfrow=c(2,2), mar=c(3,3,3,1), mgp=c(2,0.8,0))
plot(Rv.status3)
```


<br>
The diagnostic plots for `glm(Bd.endpoint.status ~ Treatment)` aren't much better 
 - I don't understand why the residuals vs. fitted plot is so different this time ?!?

